# HRMS 人力资源管理系统 - 快速开始指南

本文档将指导您快速启动和运行 HRMS 人力资源管理系统。

## 📋 系统要求

- **Go 环境**: Go 1.16 或更高版本
- **操作系统**: Windows、Linux、macOS
- **浏览器**: Chrome、Firefox、Safari 等现代浏览器

## 🚀 快速启动

### 1. 依赖安装

系统只需要安装 Go 环境即可，无需其他外部依赖。

**安装 Go 环境：**
- 访问 [Go 官网](https://golang.org/dl/) 下载并安装
- 验证安装：`go version`

### 2. 获取项目代码

```bash
git clone https://github.com/pbrong/hrms.git
cd hrms
go mod tidy
```

### 3. 数据准备

执行数据库初始化脚本，自动创建 SQLite 数据库并导入初始数据：

```bash
bash scripts/init_database.sh
```

**脚本功能：**
- 自动创建 SQLite 数据库文件
- 导入基础数据（部门、职级、员工、权限等）
- 备份现有数据库（如果存在）
- 验证数据库结构完整性

### 4. 启动服务

使用构建脚本启动开发环境：

```bash
bash build.sh run
```

**服务配置：**
- **默认端口**: 8888
- **配置文件**: [`config/config-dev.yaml`](config/config-dev.yaml:1)
- **数据库**: SQLite (位于 `./data/hrms_C001.db`)

### 5. 访问系统

在浏览器中访问：

```
http://127.0.0.1:8888/index
```

**默认登录账号：**
- **用户名**: admin
- **密码**: admin1
- **分公司**: 广州总部

## 🧪 执行测试

### 1. 创建测试配置

复制开发配置文件作为测试配置：

```bash
cp config/config-dev.yaml config/config-test.yaml
```

### 2. 修改测试端口

编辑 [`config/config-test.yaml`](config/config-test.yaml:1) 文件，修改端口为未被占用的端口：

```yaml
gin:
  port: 8889  # 修改为其他端口，避免与开发环境冲突
db:
  type: sqlite
  path: ./data
  dbName: hrms_C001
```

### 3. 运行测试

执行 API 测试脚本：

```bash
bash scripts/test_api.sh
```

**测试功能：**
- API 接口测试
- 页面访问性测试
- 权限验证测试
- 数据操作测试

**测试选项：**
```bash
# 运行所有测试
bash scripts/test_api.sh

# 运行指定模块测试
bash scripts/test_api.sh -m account

# 运行指定目录测试
bash scripts/test_api.sh -d account/

# 列出所有可用模块
bash scripts/test_api.sh -l

# 只运行页面测试
bash scripts/test_api.sh --pages-only

# 跳过页面测试
bash scripts/test_api.sh --skip-pages
```

## 📁 项目结构

```
hrms/
├── config/          # 配置文件
├── handler/         # 路由处理层
├── model/           # 数据模型层
├── service/         # 业务逻辑层
├── resource/        # 资源配置层
├── views/           # 前端页面
├── static/          # 静态资源
├── data/            # SQLite 数据库文件
├── sql/             # SQL 初始化脚本
├── scripts/         # 辅助脚本
├── testcases/       # 测试用例
├── build.sh         # 构建脚本
└── main.go          # 程序入口
```

## 🔧 常用命令

### 构建相关
```bash
# 构建可执行文件
bash build.sh build

# 运行开发环境
bash build.sh run-dev

# 运行生产环境
bash build.sh run-prod

# 清理构建文件
bash build.sh clean
```

### 数据库相关
```bash
# 初始化数据库
bash scripts/init_database.sh

# 数据库迁移
bash build.sh migrate

# 重置数据库
bash build.sh migrate-reset
```

### 测试相关
```bash
# 运行所有测试
bash scripts/test_api.sh

# 运行指定模块测试
bash scripts/test_api.sh -m staff

# 显示帮助信息
bash scripts/test_api.sh -h
```

## 🎯 系统功能

### 权限体系
- **超级管理员** (supersys): 系统管理权限
- **系统管理员** (sys): 分公司管理权限
- **普通用户** (normal): 基础业务权限

### 核心模块
- **员工管理**: 员工信息、部门、职级管理
- **考勤管理**: 考勤记录、审批、统计
- **薪资管理**: 薪资发放、套账管理
- **招聘管理**: 职位发布、候选人管理
- **通知管理**: 系统通知、公告发布
- **权限管理**: 用户权限、角色管理
- **考试管理**: 在线考试、成绩管理

### 技术特性
- **分公司分库**: 数据隔离，支持多分公司
- **纯 Go 实现**: 无 CGO 依赖，易于部署
- **SQLite 数据库**: 轻量级，无需额外安装
- **响应式界面**: 基于 LayUI 的现代化界面

## ❓ 常见问题

### Q: 启动时提示端口被占用？
A: 修改 [`config/config-dev.yaml`](config/config-dev.yaml:2) 中的端口号，或停止占用端口的程序。

### Q: 数据库初始化失败？
A: 检查 `data` 目录权限，确保有写入权限。删除 `data` 目录后重新运行初始化脚本。

### Q: 登录提示用户名或密码错误？
A: 确保使用默认账号 `admin/admin1`，分公司选择 `广州总部`。

### Q: 测试失败？
A: 确保测试配置文件端口与开发环境不冲突，检查服务是否正常启动。
